<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Gathering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="data gathering_files/libs/clipboard/clipboard.min.js"></script>
<script src="data gathering_files/libs/quarto-html/quarto.js"></script>
<script src="data gathering_files/libs/quarto-html/popper.min.js"></script>
<script src="data gathering_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data gathering_files/libs/quarto-html/anchor.min.js"></script>
<link href="data gathering_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data gathering_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data gathering_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data gathering_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data gathering_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Gathering</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Data gathering is the process of gathering and measuring information on targeted variables in an established system, which then enables one to answer relevant questions and evaluate outcomes. In this section, I will introduction what kind of tools I used, what kind of data I want to get related to my project, and the meaning of the data. Also, the coding process and data result will be displayed.</p>
<section id="tools-for-data-gathering" class="level3">
<h3 class="anchored" data-anchor-id="tools-for-data-gathering">Tools for Data Gathering</h3>
<ul>
<li>Twitter API</li>
</ul>
<p>The Twitter API is a set of programmatic endpoints that can be used to understand or build the conversation on Twitter. This API allows you to find and retrieve, engage with, or create a variety of different resources including the following: Tweets, Direct Messages, Spaces, Lists, users, and more.</p>
<ul>
<li>Resource from U.S. Energy Information Administration <br></li>
</ul>
<p>The U.S. Energy Information Administration (EIA) is a principal agency of the U.S. Federal Statistical System responsible for collecting, analyzing, and disseminating energy information to promote sound policymaking, efficient markets, and public understanding of energy and its interaction with the economy and the environment. EIA programs cover data on coal, petroleum, natural gas, electric, renewable and nuclear energy. EIA is part of the U.S. Department of Energy. Reference link : https://www.eia.gov/</p>
</section>
<section id="my-project-direction-and-10-questions" class="level3">
<h3 class="anchored" data-anchor-id="my-project-direction-and-10-questions">My Project Direction and 10 Questions</h3>
<ul>
<li>Directions:
<ol type="1">
<li>Analyzing people’s perceptions of energy consumption.</li>
<li>Predicting the consumption of different types of energy in the next decade.</li>
</ol></li>
<li>10 Questions:
<ol type="1">
<li>What does increased energy consumption mean for people?</li>
<li>Does clean energy matter for the environmental protection?</li>
<li>Who contributes the most to energy consumption, residence, industry, or commercial?</li>
<li>How do people think about global warming?</li>
<li>Which energy source will be consumed less in the next decade?</li>
<li>What will the overall energy consumption level look like in the next decade?</li>
<li>Will demand for traditional energy sources, such as oil, decline?</li>
<li>Will people choose new energy products? Such as electric cars?</li>
<li>Can new energy replace traditional energy?</li>
<li>Will new energy consumption continue to grow in the next decade?</li>
</ol></li>
</ul>
</section>
<section id="data-type" class="level3">
<h3 class="anchored" data-anchor-id="data-type">Data Type</h3>
<ul>
<li>Text Data <br></li>
</ul>
<p>Text data usually consists of documents which can represent words, sentences or even paragraphs of free flowing text.</p>
<p>Since I want to study people’s attitude towards energy consumption, I want to use the Twitter API to grab the text information. I will set “energy consumption” “global warming” “clean energy” “conventional energy” “environmental protection” as the keywords for the twitter api to get the text data. The data obtained will allow me to analyze people’s attitudes towards energy consumption, how people perceive different energy sources, and also to analyze people’s attitudes towards protecting the environment in terms of energy. I will also use this text data to analyze the relationship between the environment and energy in the minds of twitter users. I will also keep adjusting the text data later for future research. In data gathering section, I used for loop to search over 600 tweets in order to make comprehensive datasets. I will collect more in the future to scratch over 2000 tweets in order to make sure my results are accurate. I plan to detect the frequency of words to gain a plot. More than this, I plan to use Naive Bytes to give each tweet a positive or negative attitude.</p>
<ul>
<li>Downloaded Dataset</li>
</ul>
<p>The data we can collect in our daily life is limited and cannot be guaranteed to be authentic, so we need to rely on the information provided by authorities or data miners to achieve our research needs. I will seek information from authorities, such as U.S. Energy Information Administration (EIA), to filter the datasets that are suitable for my project. According to my research direction and question, I need to collect energy consumption over a recent period of time, which can be collected by the energy consumption of different groups and the consumption of different energy types.</p>
</section>
<section id="data-collection-section" class="level2">
<h2 class="anchored" data-anchor-id="data-collection-section">Data Collection Section</h2>
<section id="twitter-api-in-python" class="level3">
<h3 class="anchored" data-anchor-id="twitter-api-in-python">Twitter API in Python</h3>
<p>I will set <strong>“energy consumption” “global warming” “clean energy” “conventional energy” “environmental protection”</strong> as the keywords for the twitter api to get the text data. The data obtained will allow me to analyze people’s attitudes towards energy consumption, how people perceive different energy sources, and also to analyze people’s attitudes towards protecting the environment in terms of energy. I can also use this text data to analyze the relationship between the environment and energy in the minds of twitter users. I will also keep adjusting the text data later for future research. In data gathering section, I used for loop to search over 600 tweets in order to make comprehensive datasets. I will collect more in the future to scratch over 2000 tweets in order to make sure my results are accurate.</p>
<ul>
<li>Step 1: The python package we will use in gathering data.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tweepy</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> json_normalize </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Step 2: Using the keys from Twitter and defined key words to scratch data into json file</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># READ FILE</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"/Users/apple/Desktop/anly-501-project-HuitingSong-1//501-project-website/codes/01-data-gathering/api-keys.json"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">input</span><span class="op">=</span>json.load(f)<span class="op">;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># LOAD KEYS INTO API</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>consumer_key<span class="op">=</span><span class="bu">input</span>[<span class="st">"consumer_key"</span>]    </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>consumer_secret<span class="op">=</span><span class="bu">input</span>[<span class="st">"consumer_secret"</span>]    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>access_token<span class="op">=</span><span class="bu">input</span>[<span class="st">"access_token"</span>]    </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>access_token_secret<span class="op">=</span><span class="bu">input</span>[<span class="st">"access_token_secret"</span>]    </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>bearer_token<span class="op">=</span><span class="bu">input</span>[<span class="st">"bearer_token"</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up Connection</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>auth <span class="op">=</span> tweepy.OAuthHandler(consumer_key, consumer_secret)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>auth.set_access_token(access_token, access_token_secret)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>api <span class="op">=</span> tweepy.API(auth)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the search_twitter function here.</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_twitter(query, max_results,tweet_fields, bearer_token <span class="op">=</span> bearer_token):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    headers <span class="op">=</span> {<span class="st">"Authorization"</span>: <span class="st">"Bearer </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(bearer_token)}</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">"https://api.twitter.com/2/tweets/search/recent?query=</span><span class="sc">{}</span><span class="st">&amp;max_results=</span><span class="sc">{}</span><span class="st">&amp;</span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(query, max_results,tweet_fields)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------------"</span>,url,<span class="st">"--------------"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.request(<span class="st">"GET"</span>, url, headers<span class="op">=</span>headers)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">Exception</span>(response.status_code, response.text)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response.json()</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>tweet_fields <span class="op">=</span> <span class="st">"tweet.fields=text,author_id,created_at,lang"</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="st">"/Users/apple/Desktop/anly-501-project-HuitingSong-1/501-project-website/data/raw data/"</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>search_tweets <span class="op">=</span> [<span class="st">"energy consumption"</span>,<span class="st">"clean energy"</span>,<span class="st">"conventional energy"</span>,<span class="st">"environmental protection"</span>,<span class="st">"global warming"</span>]</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx,val <span class="kw">in</span> <span class="bu">enumerate</span>(search_tweets):</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    tweets_jsondump <span class="op">=</span> []</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    json_response1 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    json_response2 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    json_response3 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    json_response4 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    json_response5 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    json_response6 <span class="op">=</span> search_twitter(query <span class="op">=</span> <span class="bu">str</span>(val), max_results <span class="op">=</span> <span class="dv">100</span>, tweet_fields <span class="op">=</span> tweet_fields, bearer_token<span class="op">=</span>bearer_token)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response1[<span class="st">'data'</span>]:</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response2[<span class="st">'data'</span>]:</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response3[<span class="st">'data'</span>]:</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response4[<span class="st">'data'</span>]:</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response5[<span class="st">'data'</span>]:</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> json_response6[<span class="st">'data'</span>]:</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        tweets_jsondump.append(i)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(data<span class="op">+</span><span class="bu">str</span>(val)<span class="op">+</span><span class="st">'.json'</span>,<span class="st">'w'</span>) <span class="im">as</span> json_file:</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        json.dump(tweets_jsondump,json_file)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        json_file.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=energy consumption&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=clean energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=conventional energy&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=environmental protection&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------
-------------- https://api.twitter.com/2/tweets/search/recent?query=global warming&amp;max_results=100&amp;tweet.fields=text,author_id,created_at,lang --------------</code></pre>
</div>
</div>
<ul>
<li>Step 3: Normalize the json file and form a data frame</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>twitterdf1 <span class="op">=</span> json_normalize(json_response1,<span class="st">"data"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>twitterdf2 <span class="op">=</span> json_normalize(json_response2,<span class="st">"data"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>twitterdf3 <span class="op">=</span> json_normalize(json_response3,<span class="st">"data"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>twitterdf4 <span class="op">=</span> json_normalize(json_response4,<span class="st">"data"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>twitterdf5 <span class="op">=</span> json_normalize(json_response5,<span class="st">"data"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>twitterdf6 <span class="op">=</span> json_normalize(json_response6,<span class="st">"data"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>twitterdf <span class="op">=</span> [twitterdf1,twitterdf2,twitterdf3,twitterdf4,twitterdf5,twitterdf6]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>twitterdf <span class="op">=</span> pd.concat(twitterdf)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>twitterdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              author_id                created_at  ... lang edit_history_tweet_ids
0    968222812153491456  2022-12-07T04:41:57.000Z  ...   en  [1600349875245236225]
1   1065590488957210624  2022-12-07T04:41:41.000Z  ...   en  [1600349806739984385]
2   1193823126309818368  2022-12-07T04:41:33.000Z  ...   en  [1600349771561979905]
3    771978524337004544  2022-12-07T04:41:23.000Z  ...   en  [1600349731867148288]
4             627999812  2022-12-07T04:41:16.000Z  ...   en  [1600349699445125126]
..                  ...                       ...  ...  ...                    ...
95            100076437  2022-12-07T04:18:46.000Z  ...   en  [1600344039915720704]
96           1046710010  2022-12-07T04:18:39.000Z  ...   en  [1600344009201049600]
97           2537996870  2022-12-07T04:18:29.000Z  ...   en  [1600343968834691073]
98   740348231297601537  2022-12-07T04:18:15.000Z  ...   en  [1600343908960960513]
99  1442408319608516614  2022-12-07T04:18:13.000Z  ...   en  [1600343899167289344]

[600 rows x 6 columns]</code></pre>
</div>
</div>
<ul>
<li>Step 4: Save the data frame as csv file for futhur using</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>twitterdf.to_csv(<span class="st">"/Users/apple/Desktop/anly-501-project-HuitingSong-1//501-project-website/data/raw data/twitterpython.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="twitter-api-in-r" class="level3">
<h3 class="anchored" data-anchor-id="twitter-api-in-r">Twitter API in R</h3>
<p>For Twitter API in R, I used twitter to scratch keywords like <strong>“oil”,“gas”,“solar power”,“wind power”</strong> to scratch users’ attitudes about these four kinds of energy. I want to search different types of energy in order to analysis people attitude toward different enegy, and what they think about two different kind of energy (renewable energy and convential energy).</p>
<ul>
<li>Step 1: Load the R packages</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(selectr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rtweet) <span class="co"># for scraping tweets</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROAuth)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httpuv)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(twitteR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Step 2: Using the keys from Twitter and defined key words to scratch data into json file</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>consumer_key <span class="ot">=</span> <span class="st">"zV2ER7zM1HzFUshDEHpJ8UuVS"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>consumer_secret <span class="ot">=</span> <span class="st">"5uHStDPwbFxEfLZojqPP9eDcWWXgfNCwdVPe8VG0xFvPldjhHJ"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>access_token <span class="ot">=</span> <span class="st">"1558952162692108289-bQDaHCqBuJZnXXqeQWnz7Pk1bhdiWm"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>access_token_secret <span class="ot">=</span> <span class="st">"kSJLq0tng5MfaFHoxbc7GpQ6D4SaplXzthDrW2SzhTSpD"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>bearer_token <span class="ot">=</span> <span class="st">"AAAAAAAAAAAAAAAAAAAAAEGthAEAAAAArntLVGGx5Q8Irzy%2BRTc2HdgQ7Vw%3DOR64kNsk2o0eqNl9KKZQKs7i2yzUoHEObJHwsQWiwesFtlQKdp"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>requestURL<span class="ot">=</span><span class="st">'https://api.twitter.com/oauth/request_token'</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>accessURL<span class="ot">=</span><span class="st">'https://api.twitter.com/oauth/access_token'</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>authURL<span class="ot">=</span><span class="st">'https://api.twitter.com/oauth/authorize'</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>s_key  <span class="ot">=</span> <span class="st">'gas OR oil OR solar power OR wind power'</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>n_tweets <span class="ot">=</span> <span class="dv">250</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>twitteR<span class="sc">:::</span><span class="fu">setup_twitter_oauth</span>(consumer_key, consumer_secret,access_token,access_token_secret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Using direct authentication"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Search1<span class="ot">&lt;-</span>twitteR<span class="sc">::</span><span class="fu">searchTwitter</span>(s_key,<span class="at">n=</span>n_tweets, <span class="at">since=</span><span class="st">"2022-05-01"</span>,<span class="at">lang=</span><span class="st">"en"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Step 3: Display the dataset</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>TweetsDF<span class="ot">&lt;-</span> <span class="fu">twListToDF</span>(Search1)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TweetsDF,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                          text
1 RT @alissajean: Hey FL. Your power bill is going up (again) because of decisions that your power company made to remain over-reliant on out…
2 RT @Music20Plus: @HenryLawson55 @OZzSue5 @ABCaustralia Yet, when you look at all the infrastructure required to feed power from the numerou…
3 And people said nuclear power plants are ugly. Really?? These solar farms and their cousin the wind farms are destr… https://t.co/MajIxDJbvt
4 RT @alissajean: Hey FL. Your power bill is going up (again) because of decisions that your power company made to remain over-reliant on out…
5 Trail Camera Solar Power Panel 8000mAh 3W Supporting 12V 9V 6V for All 3G 4G Hunting Game Camera or Deer Feeder GGR… https://t.co/9k2SH1GddX
  favorited favoriteCount replyToSN             created truncated replyToSID
1     FALSE             0      &lt;NA&gt; 2022-12-07 04:42:04     FALSE       &lt;NA&gt;
2     FALSE             0      &lt;NA&gt; 2022-12-07 04:41:12     FALSE       &lt;NA&gt;
3     FALSE             0      &lt;NA&gt; 2022-12-07 04:40:46      TRUE       &lt;NA&gt;
4     FALSE             0      &lt;NA&gt; 2022-12-07 04:40:22     FALSE       &lt;NA&gt;
5     FALSE             0      &lt;NA&gt; 2022-12-07 04:40:16      TRUE       &lt;NA&gt;
                   id replyToUID
1 1600349902638579712       &lt;NA&gt;
2 1600349683100299264       &lt;NA&gt;
3 1600349573805150208       &lt;NA&gt;
4 1600349474177490945       &lt;NA&gt;
5 1600349450055999489       &lt;NA&gt;
                                                                          statusSource
1 &lt;a href="http://twitter.com/download/android" rel="nofollow"&gt;Twitter for Android&lt;/a&gt;
2 &lt;a href="http://twitter.com/download/android" rel="nofollow"&gt;Twitter for Android&lt;/a&gt;
3    &lt;a href="http://twitter.com/#!/download/ipad" rel="nofollow"&gt;Twitter for iPad&lt;/a&gt;
4   &lt;a href="http://twitter.com/download/iphone" rel="nofollow"&gt;Twitter for iPhone&lt;/a&gt;
5              &lt;a href="https://mobile.twitter.com" rel="nofollow"&gt;Twitter Web App&lt;/a&gt;
       screenName retweetCount isRetweet retweeted longitude latitude
1 LawrenceForbe16          547      TRUE     FALSE        NA       NA
2         OZzSue5            1      TRUE     FALSE        NA       NA
3    Rev11Witness            0     FALSE     FALSE        NA       NA
4      CThreeFilm          547      TRUE     FALSE        NA       NA
5       casperxaf            0     FALSE     FALSE        NA       NA</code></pre>
</div>
</div>
<ul>
<li>Step 4: Save the data frame as csv file for futhur using</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(TweetsDF,<span class="st">"/Users/apple/Desktop/anly-501-project-HuitingSong-1/501-project-website/codes/01-data-gathering/twitterR.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>